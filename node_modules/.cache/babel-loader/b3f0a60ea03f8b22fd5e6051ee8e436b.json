{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.listAll = listAll;\nexports.listCompleted = listCompleted;\nexports.listAllAndCompleted = listAllAndCompleted;\n\nvar _bluebird = _interopRequireDefault(require(\"bluebird\"));\n\nvar _tableResolver = require(\"./table-resolver\");\n\nvar _tableCreator = require(\"./table-creator\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n} // Lists all available migration versions, as a sorted array.\n\n\nfunction listAll(migrationSource, loadExtensions) {\n  return migrationSource.getMigrations(loadExtensions);\n} // Lists all migrations that have been completed for the current db, as an\n// array.\n\n\nfunction listCompleted(tableName, schemaName, trxOrKnex) {\n  return (0, _tableCreator.ensureTable)(tableName, schemaName, trxOrKnex).then(function () {\n    return trxOrKnex.from((0, _tableResolver.getTableName)(tableName, schemaName)).orderBy('id').select('name');\n  }).then(function (migrations) {\n    return migrations.map(function (migration) {\n      return migration.name;\n    });\n  });\n} // Gets the migration list from the migration directory specified in config, as well as\n// the list of completed migrations to check what should be run.\n\n\nfunction listAllAndCompleted(config, trxOrKnex) {\n  return _bluebird.default.all([listAll(config.migrationSource), listCompleted(config.tableName, config.schemaName, trxOrKnex)]);\n}","map":null,"metadata":{},"sourceType":"script"}