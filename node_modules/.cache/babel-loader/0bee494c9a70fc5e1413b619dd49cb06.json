{"ast":null,"code":"import _classCallCheck from \"/Users/phill/Documents/RMIT/2019Sem1/COSC2408/JPLCarShare/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/phill/Documents/RMIT/2019Sem1/COSC2408/JPLCarShare/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/phill/Documents/RMIT/2019Sem1/COSC2408/JPLCarShare/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/phill/Documents/RMIT/2019Sem1/COSC2408/JPLCarShare/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/phill/Documents/RMIT/2019Sem1/COSC2408/JPLCarShare/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/phill/Documents/RMIT/2019Sem1/COSC2408/JPLCarShare/src/CarList.js\";\nimport React, { Component } from 'react';\n\nvar knex = require('knex')(require('../server/db/knexfile'));\n\nvar CarList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CarList, _Component);\n\n  function CarList(props) {\n    var _this;\n\n    _classCallCheck(this, CarList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CarList).call(this, props));\n    _this.state = {\n      cars: _this.getCars()\n    };\n\n    _this.sortCars([_this.props.latitude, _this.props.longitude], _this.state.cars);\n\n    return _this;\n  }\n  /**\tGets the distance between two points (lat1, lon1) & (lat2, long2)\n  *\tand returns it in metres\n  *\tFunction uses the Haversine distance\n  *\tImplementation adapted from GeoSourceData.com's function in Javascript\n  **/\n\n\n  _createClass(CarList, [{\n    key: \"getDistance\",\n    value: function getDistance(lat1, lon1, lat2, lon2) {\n      var SEMI_CIRCLE_DEGREES = 180;\n      var radlat1 = Math.PI * lat1 / SEMI_CIRCLE_DEGREES;\n      var radlat2 = Math.PI * lat2 / SEMI_CIRCLE_DEGREES;\n      var radlon1 = Math.PI * lon1 / SEMI_CIRCLE_DEGREES;\n      var radlon2 = Math.PI * lon2 / SEMI_CIRCLE_DEGREES;\n      var theta = lon1 - lon2;\n      var radtheta = Math.PI * theta / SEMI_CIRCLE_DEGREES;\n      var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);\n      dist = Math.acos(dist);\n      dist = dist * SEMI_CIRCLE_DEGREES / Math.PI;\n      dist = dist * (SEMI_CIRCLE_DEGREES / 2) * 1.1515;\n      dist = dist * 1.609344;\n      return dist;\n    }\n  }, {\n    key: \"sortCars\",\n    value: function sortCars(userposition, cars) {\n      var userlat = userposition.coords.latitude;\n      var userlong = userposition.coords.longitude;\n      this.state.cars.sort(function (a, b) {\n        if (getDistance(userlat, userlong, a.latitude, a.longitude) < getDistance(userlat, userlong, b.latitude, b.longitude)) {\n          return -1;\n        } else {\n          return 1;\n        }\n\n        ;\n      });\n    }\n  }, {\n    key: \"getCars\",\n    value: function getCars() {\n      return knex.select().from('cars');\n    }\n  }, {\n    key: \"render\",\n    value: function render(props) {\n      var carlist = this.state.cars.map(function (car, rego) {\n        return React.createElement(\"li\", {\n          key: car.rego,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 57\n          },\n          __self: this\n        }, car.make);\n      });\n      return React.createElement(\"div\", {\n        classname: \"CarList\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }, React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, carlist));\n    }\n  }]);\n\n  return CarList;\n}(Component);\n\nexport default CarList;","map":{"version":3,"sources":["/Users/phill/Documents/RMIT/2019Sem1/COSC2408/JPLCarShare/src/CarList.js"],"names":["React","Component","knex","require","CarList","props","state","cars","getCars","sortCars","latitude","longitude","lat1","lon1","lat2","lon2","SEMI_CIRCLE_DEGREES","radlat1","Math","PI","radlat2","radlon1","radlon2","theta","radtheta","dist","sin","cos","acos","userposition","userlat","coords","userlong","sort","a","b","getDistance","select","from","carlist","map","car","rego","make"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nconst knex = require('knex')(require('../server/db/knexfile'));\n\nclass CarList extends Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tcars: this.getCars()\n\t\t};\n\t\tthis.sortCars([this.props.latitude, this.props.longitude], this.state.cars);\n\t}\n\n\t/**\tGets the distance between two points (lat1, lon1) & (lat2, long2)\n\t*\tand returns it in metres\n\t*\tFunction uses the Haversine distance\n\t*\tImplementation adapted from GeoSourceData.com's function in Javascript\n\t**/\n\tgetDistance(lat1, lon1, lat2, lon2) {\n\t\tconst SEMI_CIRCLE_DEGREES = 180;\n\t    var radlat1 = Math.PI * lat1/SEMI_CIRCLE_DEGREES;\n\t    var radlat2 = Math.PI * lat2/SEMI_CIRCLE_DEGREES;\n\t    var radlon1 = Math.PI * lon1/SEMI_CIRCLE_DEGREES;\n\t    var radlon2 = Math.PI * lon2/SEMI_CIRCLE_DEGREES;\n\t    var theta = lon1-lon2;\n\t    var radtheta = Math.PI * theta/SEMI_CIRCLE_DEGREES;\n\t    var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);\n\t    dist = Math.acos(dist);\n\t    dist = dist * SEMI_CIRCLE_DEGREES/Math.PI;\n\t    dist = dist * (SEMI_CIRCLE_DEGREES / 2) * 1.1515;\n\t    dist = dist * 1.609344;\n\t    return dist\n\t}\n\n\tsortCars(userposition, cars) {\n\t\tvar userlat = userposition.coords.latitude;\n\t\tvar userlong = userposition.coords.longitude;\n\n\t\tthis.state.cars.sort(function(a,b) {\n\t\t\tif (getDistance(userlat, userlong, a.latitude, a.longitude) < getDistance(userlat, userlong, b.latitude, b.longitude)) {\n\t\t\t\treturn -1;\n\t\t\t} else {\n\t\t\t\treturn 1;\n\t\t\t};\n\t\t});\n\t}\n\n\tgetCars() {\n\t\treturn knex.select().from('cars');\n\t}\n\n\n\n\trender(props) {\n\t\tconst carlist = this.state.cars.map((car, rego)=>\n\t\t\t\t<li key={car.rego}>{car.make}</li>\n\t\t\t\t);\n\t\treturn (\n\t\t\t\n\t\t\t<div classname=\"CarList\">\n\t\t\t\t<ul>\n\t\t\t\t\t{carlist}\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default CarList;\n"]},"metadata":{},"sourceType":"module"}