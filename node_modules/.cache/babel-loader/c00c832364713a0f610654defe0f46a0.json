{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _inherits = _interopRequireDefault(require(\"inherits\"));\n\nvar _events = require(\"events\");\n\nvar _lodash = require(\"lodash\");\n\nvar _helpers = require(\"../helpers\");\n\nvar _saveAsyncStack = _interopRequireDefault(require(\"../util/save-async-stack\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n} // Constructor for the builder instance, typically called from\n// `knex.builder`, accepting the current `knex` instance,\n// and pulling out the `client` and `grammar` from the current\n// knex instance.\n\n\nfunction SchemaBuilder(client) {\n  this.client = client;\n  this._sequence = [];\n\n  if (client.config) {\n    this._debug = client.config.debug;\n    (0, _saveAsyncStack.default)(this, 4);\n  }\n}\n\n(0, _inherits.default)(SchemaBuilder, _events.EventEmitter); // Each of the schema builder methods just add to the\n// \"_sequence\" array for consistency.\n\n(0, _lodash.each)(['createTable', 'createTableIfNotExists', 'createSchema', 'createSchemaIfNotExists', 'dropSchema', 'dropSchemaIfExists', 'createExtension', 'createExtensionIfNotExists', 'dropExtension', 'dropExtensionIfExists', 'table', 'alterTable', 'hasTable', 'hasColumn', 'dropTable', 'renameTable', 'dropTableIfExists', 'raw'], function (method) {\n  SchemaBuilder.prototype[method] = function () {\n    if (method === 'createTableIfNotExists') {\n      this.client.logger.warn(['Use async .hasTable to check if table exists and then use plain .createTable. Since ', '.createTableIfNotExists actually just generates plain \"CREATE TABLE IF NOT EXIST...\" ', 'query it will not work correctly if there are any alter table queries generated for ', 'columns afterwards. To not break old migrations this function is left untouched for now', ', but it should not be used when writing new code and it is removed from documentation.'].join(''));\n    }\n\n    if (method === 'table') method = 'alterTable';\n\n    this._sequence.push({\n      method: method,\n      args: (0, _lodash.toArray)(arguments)\n    });\n\n    return this;\n  };\n});\n\nrequire('../interface')(SchemaBuilder);\n\n(0, _helpers.addQueryContext)(SchemaBuilder);\n\nSchemaBuilder.prototype.withSchema = function (schemaName) {\n  this._schema = schemaName;\n  return this;\n};\n\nSchemaBuilder.prototype.toString = function () {\n  return this.toQuery();\n};\n\nSchemaBuilder.prototype.toSQL = function () {\n  return this.client.schemaCompiler(this).toSQL();\n};\n\nvar _default = SchemaBuilder;\nexports.default = _default;\nmodule.exports = exports.default;","map":null,"metadata":{},"sourceType":"script"}