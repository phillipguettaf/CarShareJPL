{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = parseConnectionString;\n\nvar _url = _interopRequireDefault(require(\"url\"));\n\nvar _pgConnectionString = require(\"pg-connection-string\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction parseConnectionString(str) {\n  var parsed = _url.default.parse(str);\n\n  var protocol = parsed.protocol;\n\n  if (protocol === null) {\n    return {\n      client: 'sqlite3',\n      connection: {\n        filename: str\n      }\n    };\n  }\n\n  if (protocol.slice(-1) === ':') {\n    protocol = protocol.slice(0, -1);\n  }\n\n  var isPG = ['postgresql', 'postgres'].includes(protocol);\n  return {\n    client: protocol,\n    connection: isPG ? (0, _pgConnectionString.parse)(str) : connectionObject(parsed)\n  };\n}\n\nfunction connectionObject(parsed) {\n  var connection = {};\n  var db = parsed.pathname;\n\n  if (db[0] === '/') {\n    db = db.slice(1);\n  }\n\n  connection.database = db;\n\n  if (parsed.hostname) {\n    if (parsed.protocol.indexOf('mssql') === 0) {\n      connection.server = parsed.hostname;\n    } else {\n      connection.host = parsed.hostname;\n    }\n  }\n\n  if (parsed.port) {\n    connection.port = parsed.port;\n  }\n\n  if (parsed.auth) {\n    var idx = parsed.auth.indexOf(':');\n\n    if (idx !== -1) {\n      connection.user = parsed.auth.slice(0, idx);\n\n      if (idx < parsed.auth.length - 1) {\n        connection.password = parsed.auth.slice(idx + 1);\n      }\n    } else {\n      connection.user = parsed.auth;\n    }\n  }\n\n  return connection;\n}\n\nmodule.exports = exports.default;","map":null,"metadata":{},"sourceType":"script"}